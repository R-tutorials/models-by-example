<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Probit &amp; Bivariate Probit | Model Estimation by Example</title>
  <meta name="description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Probit &amp; Bivariate Probit | Model Estimation by Example" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/models-by-example/" />
  <meta property="og:image" content="https://m-clark.github.io/models-by-example/img/nineteeneightyR.png" />
  <meta property="og:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="github-repo" content="m-clark/models-by-example/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Probit &amp; Bivariate Probit | Model Estimation by Example" />
  
  <meta name="twitter:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="twitter:image" content="https://m-clark.github.io/models-by-example/img/nineteeneightyR.png" />



<meta name="date" content="2020-11-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="mixed-model-ML.html"/>
<link rel="next" href="heckman-selection.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Model Estimation by Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Models</b></span></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Standard Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#data-setup"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#obtain-model-estimates"><i class="fa fa-check"></i>Obtain Model Estimates</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Standard Logistic</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#data-setup-1"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#functions-1"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#obtain-model-estimates-1"><i class="fa fa-check"></i>Obtain Model Estimates</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-1"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#source-1"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html"><i class="fa fa-check"></i>One-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#main-function"><i class="fa fa-check"></i>Main function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#data-set-up"><i class="fa fa-check"></i>Data set up</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#estimation"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#comparison-2"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#source-2"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html"><i class="fa fa-check"></i>Two-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#main-function-1"><i class="fa fa-check"></i>Main function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#data-set-up-1"><i class="fa fa-check"></i>Data set up</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#estimation-1"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#comparison-3"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#source-3"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html"><i class="fa fa-check"></i>Mixed Model via ML</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#maximum-likelihood-estimation"><i class="fa fa-check"></i>Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#ml-function"><i class="fa fa-check"></i>ML function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#issues-with-ml-estimation"><i class="fa fa-check"></i>Issues with ML estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#link-with-penalized-regression"><i class="fa fa-check"></i>Link with penalized regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#source-4"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html"><i class="fa fa-check"></i>Probit &amp; Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#standard-probit"><i class="fa fa-check"></i>standard probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#bivariate-probit"><i class="fa fa-check"></i>Bivariate probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#source-5"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html"><i class="fa fa-check"></i>Heckman Selection</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#data-setup-2"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-approach"><i class="fa fa-check"></i>2 step approach</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-1-probit-model"><i class="fa fa-check"></i>Step 1: Probit Model</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-2-estimate-via-linear-regression"><i class="fa fa-check"></i>Step 2: Estimate via linear regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#maximum-likelihood"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#comparison-4"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#source-6"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html"><i class="fa fa-check"></i>Tobit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#demonstrate-censoring-with-an-upper-limit"><i class="fa fa-check"></i>Demonstrate Censoring with an Upper Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#data-setup-3"><i class="fa fa-check"></i>Data setup</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-5"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#demonstrate-censoring-with-a-lower-limit"><i class="fa fa-check"></i>Demonstrate censoring with a Lower Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-6"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#source-7"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i>Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#initialization"><i class="fa fa-check"></i>Initialization</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#comparison-7"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#source-8"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i>Multinomial</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#standard-categorical-model"><i class="fa fa-check"></i>Standard (categorical) model</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#import-data-and-setup"><i class="fa fa-check"></i>Import data and setup</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#multinomial-via-maximum-likelihood"><i class="fa fa-check"></i>Multinomial via Maximum Likelihood</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-8"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#alternative-specific-and-constant-variables"><i class="fa fa-check"></i>Alternative specific and constant variables</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-9"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#source-9"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i>Ordinal</a>
<ul>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#data-1"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#estimation-2"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#comparison-10"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#source-10"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Algorithms</b></span></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html"><i class="fa fa-check"></i>Penalized Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-4"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#functions-2"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#obtain-model-estimates-2"><i class="fa fa-check"></i>Obtain Model Estimates</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-11"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-11"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html"><i class="fa fa-check"></i>L1 (lasso) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#functions-3"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#data-setup-5"><i class="fa fa-check"></i>Data setup</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#comparison-12"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#source-12"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html"><i class="fa fa-check"></i>L2 (ridge) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#comparison-13"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#source-13"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html"><i class="fa fa-check"></i>Newton and IRLS</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#glm-estimation-examples"><i class="fa fa-check"></i>GLM estimation examples</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#data-prep"><i class="fa fa-check"></i>Data Prep</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#functions-4"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#newtons-method"><i class="fa fa-check"></i>Newton’s method</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#irls"><i class="fa fa-check"></i>IRLS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#comparison-14"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#source-14"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html"><i class="fa fa-check"></i>Nelder Mead</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#first-version"><i class="fa fa-check"></i>First version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-1"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#second-version"><i class="fa fa-check"></i>Second version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-function"><i class="fa fa-check"></i>Example function</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model-1"><i class="fa fa-check"></i>A Regression Model</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#comparison-16"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#source-15"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html"><i class="fa fa-check"></i>Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#data-setup-7"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#gradient-descent-algorithm"><i class="fa fa-check"></i>Gradient Descent Algorithm</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#run"><i class="fa fa-check"></i>Run</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#comparison-17"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#source-16"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html"><i class="fa fa-check"></i>Stochastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-8"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#stochastic-gradient-descent-algorithm"><i class="fa fa-check"></i>Stochastic Gradient Descent Algorithm</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#run-1"><i class="fa fa-check"></i>Run</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-18"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-set-shift"><i class="fa fa-check"></i>Data Set Shift</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#run-2"><i class="fa fa-check"></i>Run</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-19"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-1"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#source-17"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Other</b></span></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-languages"><i class="fa fa-check"></i>Other Languages</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#algorithms"><i class="fa fa-check"></i>Algorithms</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Estimation by Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="probit-bivariate-probit" class="section level1">
<h1>Probit &amp; Bivariate Probit</h1>
<p>Stata’s seems to be the primary audience concerned with these models, but I
thought I’d play around with one here (I’ve never had reason to use a probit
model in practice). Stata examples come from the UCLA ATS website and the Stata
manual so one can investigate the Stata result for comparison.</p>
<div id="standard-probit" class="section level2">
<h2>standard probit</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="probit.html#cb60-1"></a>probitLL =<span class="st"> </span><span class="cf">function</span>(beta, X, y){</span>
<span id="cb60-2"><a href="probit.html#cb60-2"></a>  mu =<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>beta</span>
<span id="cb60-3"><a href="probit.html#cb60-3"></a>  </span>
<span id="cb60-4"><a href="probit.html#cb60-4"></a>  <span class="co"># these produce identical results, but the second is the typical depiction</span></span>
<span id="cb60-5"><a href="probit.html#cb60-5"></a>  ll =<span class="st"> </span><span class="kw">sum</span>(<span class="kw">dbinom</span>(</span>
<span id="cb60-6"><a href="probit.html#cb60-6"></a>    y,</span>
<span id="cb60-7"><a href="probit.html#cb60-7"></a>    <span class="dt">size =</span> <span class="dv">1</span>,</span>
<span id="cb60-8"><a href="probit.html#cb60-8"></a>    <span class="dt">prob =</span> <span class="kw">pnorm</span>(mu),</span>
<span id="cb60-9"><a href="probit.html#cb60-9"></a>    <span class="dt">log =</span> T</span>
<span id="cb60-10"><a href="probit.html#cb60-10"></a>  ))</span>
<span id="cb60-11"><a href="probit.html#cb60-11"></a>  </span>
<span id="cb60-12"><a href="probit.html#cb60-12"></a>  <span class="co"># ll = sum(y * pnorm(mu, log = T) + (1 - y) * log(1 - pnorm(mu)))</span></span>
<span id="cb60-13"><a href="probit.html#cb60-13"></a>  </span>
<span id="cb60-14"><a href="probit.html#cb60-14"></a>  <span class="op">-</span>ll</span>
<span id="cb60-15"><a href="probit.html#cb60-15"></a>}</span></code></pre></div>
<div id="examples" class="section level3">
<h3>Examples</h3>
<p>Example 1 available at <a href="https://stats.idre.ucla.edu/stata/dae/probit-regression/" class="uri">https://stats.idre.ucla.edu/stata/dae/probit-regression/</a></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="probit.html#cb61-1"></a>admit =<span class="st"> </span>haven<span class="op">::</span><span class="kw">read_dta</span>(<span class="st">&#39;https://stats.idre.ucla.edu/stat/stata/dae/binary.dta&#39;</span>)</span>
<span id="cb61-2"><a href="probit.html#cb61-2"></a></span>
<span id="cb61-3"><a href="probit.html#cb61-3"></a><span class="kw">head</span>(admit)</span></code></pre></div>
<pre><code># A tibble: 6 x 4
  admit   gre   gpa  rank
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0   380  3.61     3
2     1   660  3.67     3
3     1   800  4        1
4     1   640  3.19     4
5     0   520  2.93     4
6     1   760  3        2</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="probit.html#cb63-1"></a>X =<span class="st"> </span><span class="kw">model.matrix</span>(admit<span class="op">~</span><span class="st"> </span>gre <span class="op">+</span><span class="st"> </span>gpa <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(rank), admit)</span>
<span id="cb63-2"><a href="probit.html#cb63-2"></a>y =<span class="st"> </span>admit<span class="op">$</span>admit</span>
<span id="cb63-3"><a href="probit.html#cb63-3"></a></span>
<span id="cb63-4"><a href="probit.html#cb63-4"></a>init =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">ncol</span>(X))</span>
<span id="cb63-5"><a href="probit.html#cb63-5"></a></span>
<span id="cb63-6"><a href="probit.html#cb63-6"></a>optimResult =<span class="st"> </span><span class="kw">optim</span>(</span>
<span id="cb63-7"><a href="probit.html#cb63-7"></a>  <span class="dt">fn  =</span> probitLL,</span>
<span id="cb63-8"><a href="probit.html#cb63-8"></a>  <span class="dt">par =</span> init,</span>
<span id="cb63-9"><a href="probit.html#cb63-9"></a>  <span class="dt">X =</span> X,</span>
<span id="cb63-10"><a href="probit.html#cb63-10"></a>  <span class="dt">y =</span> y,</span>
<span id="cb63-11"><a href="probit.html#cb63-11"></a>  <span class="dt">method =</span> <span class="st">&#39;BFGS&#39;</span></span>
<span id="cb63-12"><a href="probit.html#cb63-12"></a>)</span>
<span id="cb63-13"><a href="probit.html#cb63-13"></a></span>
<span id="cb63-14"><a href="probit.html#cb63-14"></a>optimResult </span></code></pre></div>
<pre><code>$par
[1] -2.2518260555  0.0007915268  0.5453357468 -0.4211611887 -0.8285356685 -0.9457812896

$value
[1] 229.6227

$counts
function gradient 
     140       11 

$convergence
[1] 0

$message
NULL</code></pre>
<p>Example 2 from Stata manual on <a href="http://www.stata.com/manuals13/rprobit.pdf">standard probit</a></p>
<blockquote>
<p>We have data on the make, weight, and mileage rating of 22 foreign and 52 domestic automobiles. We wish to fit a probit model explaining whether a car is foreign based on its weight and mileage."</p>
</blockquote>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="probit.html#cb65-1"></a>auto =<span class="st"> </span>haven<span class="op">::</span><span class="kw">read_dta</span>(<span class="st">&#39;http://www.stata-press.com/data/r13/auto.dta&#39;</span>)</span>
<span id="cb65-2"><a href="probit.html#cb65-2"></a></span>
<span id="cb65-3"><a href="probit.html#cb65-3"></a><span class="kw">head</span>(auto)</span></code></pre></div>
<pre><code># A tibble: 6 x 12
  make          price   mpg rep78 headroom trunk weight length  turn displacement gear_ratio      foreign
  &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl+lbl&gt;
1 AMC Concord    4099    22     3      2.5    11   2930    186    40          121       3.58 0 [Domestic]
2 AMC Pacer      4749    17     3      3      11   3350    173    40          258       2.53 0 [Domestic]
3 AMC Spirit     3799    22    NA      3      12   2640    168    35          121       3.08 0 [Domestic]
4 Buick Century  4816    20     3      4.5    16   3250    196    40          196       2.93 0 [Domestic]
5 Buick Electra  7827    15     4      4      20   4080    222    43          350       2.41 0 [Domestic]
6 Buick LeSabre  5788    18     3      4      21   3670    218    43          231       2.73 0 [Domestic]</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="probit.html#cb67-1"></a>X =<span class="st"> </span><span class="kw">model.matrix</span>(foreign<span class="op">~</span><span class="st"> </span>weight <span class="op">+</span><span class="st"> </span>mpg, auto)</span>
<span id="cb67-2"><a href="probit.html#cb67-2"></a>y =<span class="st"> </span>auto<span class="op">$</span>foreign</span>
<span id="cb67-3"><a href="probit.html#cb67-3"></a></span>
<span id="cb67-4"><a href="probit.html#cb67-4"></a>init =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">ncol</span>(X))</span>
<span id="cb67-5"><a href="probit.html#cb67-5"></a></span>
<span id="cb67-6"><a href="probit.html#cb67-6"></a>optimResult =<span class="st"> </span><span class="kw">optim</span>(</span>
<span id="cb67-7"><a href="probit.html#cb67-7"></a>  <span class="dt">fn  =</span> probitLL,</span>
<span id="cb67-8"><a href="probit.html#cb67-8"></a>  <span class="dt">par =</span> init,</span>
<span id="cb67-9"><a href="probit.html#cb67-9"></a>  <span class="dt">X =</span> X,</span>
<span id="cb67-10"><a href="probit.html#cb67-10"></a>  <span class="dt">y =</span> y</span>
<span id="cb67-11"><a href="probit.html#cb67-11"></a>)</span>
<span id="cb67-12"><a href="probit.html#cb67-12"></a></span>
<span id="cb67-13"><a href="probit.html#cb67-13"></a>optimResult</span></code></pre></div>
<pre><code>$par
[1]  8.277015097 -0.002335939 -0.103973147

$value
[1] 26.84419

$counts
function gradient 
     380       NA 

$convergence
[1] 0

$message
NULL</code></pre>
</div>
</div>
<div id="bivariate-probit" class="section level2">
<h2>Bivariate probit</h2>
<p>Main function.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="probit.html#cb69-1"></a>bivariateProbitLL =<span class="st"> </span><span class="cf">function</span>(pars, X, y1, y2) {</span>
<span id="cb69-2"><a href="probit.html#cb69-2"></a>  rho =<span class="st"> </span>pars[<span class="dv">1</span>]</span>
<span id="cb69-3"><a href="probit.html#cb69-3"></a>  mu1 =<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>pars[<span class="dv">2</span><span class="op">:</span>(<span class="kw">ncol</span>(X) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)]</span>
<span id="cb69-4"><a href="probit.html#cb69-4"></a>  mu2 =<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>pars[(<span class="kw">ncol</span>(X) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)<span class="op">:</span><span class="kw">length</span>(pars)]</span>
<span id="cb69-5"><a href="probit.html#cb69-5"></a>  q1  =<span class="st"> </span><span class="kw">ifelse</span>(y1 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb69-6"><a href="probit.html#cb69-6"></a>  q2  =<span class="st"> </span><span class="kw">ifelse</span>(y2 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb69-7"><a href="probit.html#cb69-7"></a>  </span>
<span id="cb69-8"><a href="probit.html#cb69-8"></a>  <span class="kw">require</span>(mnormt)</span>
<span id="cb69-9"><a href="probit.html#cb69-9"></a>  eta1 =<span class="st"> </span>q1 <span class="op">*</span><span class="st"> </span>mu1</span>
<span id="cb69-10"><a href="probit.html#cb69-10"></a>  eta2 =<span class="st"> </span>q2 <span class="op">*</span><span class="st"> </span>mu2</span>
<span id="cb69-11"><a href="probit.html#cb69-11"></a>  </span>
<span id="cb69-12"><a href="probit.html#cb69-12"></a>  ll =<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> <span class="kw">nrow</span>(X))</span>
<span id="cb69-13"><a href="probit.html#cb69-13"></a>  </span>
<span id="cb69-14"><a href="probit.html#cb69-14"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(ll)) {</span>
<span id="cb69-15"><a href="probit.html#cb69-15"></a>    corr =<span class="st"> </span>q1[i] <span class="op">*</span><span class="st"> </span>q2[i] <span class="op">*</span><span class="st"> </span>rho</span>
<span id="cb69-16"><a href="probit.html#cb69-16"></a>    corr =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, corr, corr, <span class="dv">1</span>), <span class="dv">2</span>)</span>
<span id="cb69-17"><a href="probit.html#cb69-17"></a>    ll[i] =<span class="st"> </span><span class="kw">log</span>(</span>
<span id="cb69-18"><a href="probit.html#cb69-18"></a>      <span class="kw">pmnorm</span>(</span>
<span id="cb69-19"><a href="probit.html#cb69-19"></a>        <span class="dt">x =</span> <span class="kw">c</span>(eta1[i], eta2[i]),</span>
<span id="cb69-20"><a href="probit.html#cb69-20"></a>        <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb69-21"><a href="probit.html#cb69-21"></a>        <span class="dt">varcov =</span> corr</span>
<span id="cb69-22"><a href="probit.html#cb69-22"></a>      )</span>
<span id="cb69-23"><a href="probit.html#cb69-23"></a>    )</span>
<span id="cb69-24"><a href="probit.html#cb69-24"></a>  }</span>
<span id="cb69-25"><a href="probit.html#cb69-25"></a>  </span>
<span id="cb69-26"><a href="probit.html#cb69-26"></a>  <span class="co"># the loop is probably clearer, and there is no difference in time, but here&#39;s</span></span>
<span id="cb69-27"><a href="probit.html#cb69-27"></a>  <span class="co"># a oneliner ll = mapply(function(e1, e2, q1, q2) log(pmnorm(x = c(e1, e2),</span></span>
<span id="cb69-28"><a href="probit.html#cb69-28"></a>  <span class="co"># varcov = matrix(c(1,q1*q2*rho,q1*q2*rho,1),2))), eta1, eta2, q1, q2)</span></span>
<span id="cb69-29"><a href="probit.html#cb69-29"></a>  </span>
<span id="cb69-30"><a href="probit.html#cb69-30"></a>  <span class="op">-</span><span class="kw">sum</span>(ll)</span>
<span id="cb69-31"><a href="probit.html#cb69-31"></a>}</span></code></pre></div>
<div id="example" class="section level3">
<h3>Example</h3>
<p>From stata manual on bivariate probit:</p>
<blockquote>
<p>We wish to model the bivariate outcomes of whether children attend private
school and whether the head of the household voted for an increase in property
tax based on the other covariates.</p>
</blockquote>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="probit.html#cb70-1"></a>school =<span class="st"> </span>haven<span class="op">::</span><span class="kw">read_dta</span>(<span class="st">&#39;http://www.stata-press.com/data/r13/school.dta&#39;</span>)</span>
<span id="cb70-2"><a href="probit.html#cb70-2"></a></span>
<span id="cb70-3"><a href="probit.html#cb70-3"></a><span class="kw">head</span>(school)</span></code></pre></div>
<pre><code># A tibble: 6 x 11
    obs pub12 pub34  pub5 private years school loginc logptax  vote logeduc
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1     1     0     1     0       0    10      1   9.77    7.05     1    7.21
2     2     0     1     0       0     8      0  10.0     7.05     0    7.61
3     3     1     0     0       0     4      0  10.0     7.05     0    8.28
4     4     0     1     0       0    13      0   9.43    6.40     0    6.82
5     5     0     1     0       0     3      1  10.0     7.28     1    7.69
6     6     1     0     0       0     5      0  10.5     7.05     0    6.91</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="probit.html#cb72-1"></a>X  =<span class="st"> </span><span class="kw">model.matrix</span>(private <span class="op">~</span><span class="st"> </span>years <span class="op">+</span><span class="st"> </span>logptax <span class="op">+</span><span class="st"> </span>loginc, school)</span>
<span id="cb72-2"><a href="probit.html#cb72-2"></a>y1 =<span class="st"> </span>school<span class="op">$</span>private</span>
<span id="cb72-3"><a href="probit.html#cb72-3"></a>y2 =<span class="st"> </span>school<span class="op">$</span>vote</span>
<span id="cb72-4"><a href="probit.html#cb72-4"></a></span>
<span id="cb72-5"><a href="probit.html#cb72-5"></a>init =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">ncol</span>(X)<span class="op">*</span><span class="dv">2</span>))</span>
<span id="cb72-6"><a href="probit.html#cb72-6"></a></span>
<span id="cb72-7"><a href="probit.html#cb72-7"></a><span class="co"># you&#39;ll probably get a warning or two, ignore; takes a couple seconds</span></span>
<span id="cb72-8"><a href="probit.html#cb72-8"></a>optimResult =<span class="st"> </span><span class="kw">optim</span>(</span>
<span id="cb72-9"><a href="probit.html#cb72-9"></a>  <span class="dt">fn  =</span> bivariateProbitLL,</span>
<span id="cb72-10"><a href="probit.html#cb72-10"></a>  <span class="dt">par =</span> init,</span>
<span id="cb72-11"><a href="probit.html#cb72-11"></a>  <span class="dt">X   =</span> X,</span>
<span id="cb72-12"><a href="probit.html#cb72-12"></a>  <span class="dt">y1  =</span> y1,</span>
<span id="cb72-13"><a href="probit.html#cb72-13"></a>  <span class="dt">y2  =</span> y2,</span>
<span id="cb72-14"><a href="probit.html#cb72-14"></a>  <span class="dt">method =</span> <span class="st">&#39;BFGS&#39;</span></span>
<span id="cb72-15"><a href="probit.html#cb72-15"></a>)</span>
<span id="cb72-16"><a href="probit.html#cb72-16"></a></span>
<span id="cb72-17"><a href="probit.html#cb72-17"></a></span>
<span id="cb72-18"><a href="probit.html#cb72-18"></a>loglik =<span class="st"> </span>optimResult<span class="op">$</span>value</span>
<span id="cb72-19"><a href="probit.html#cb72-19"></a>rho =<span class="st"> </span>optimResult<span class="op">$</span>par[<span class="dv">1</span>]</span>
<span id="cb72-20"><a href="probit.html#cb72-20"></a>coefsPrivate =<span class="st"> </span>optimResult<span class="op">$</span>par[<span class="dv">2</span><span class="op">:</span>(<span class="kw">ncol</span>(X) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)]</span>
<span id="cb72-21"><a href="probit.html#cb72-21"></a>coefsVote =<span class="st"> </span>optimResult<span class="op">$</span>par[(<span class="kw">ncol</span>(X) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)<span class="op">:</span><span class="kw">length</span>(init)]</span>
<span id="cb72-22"><a href="probit.html#cb72-22"></a><span class="kw">names</span>(coefsPrivate) =<span class="st"> </span><span class="kw">names</span>(coefsVote) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Int&#39;</span>, <span class="st">&#39;years&#39;</span>, <span class="st">&#39;logptax&#39;</span>, <span class="st">&#39;loginc&#39;</span>)</span>
<span id="cb72-23"><a href="probit.html#cb72-23"></a></span>
<span id="cb72-24"><a href="probit.html#cb72-24"></a><span class="kw">list</span>(</span>
<span id="cb72-25"><a href="probit.html#cb72-25"></a>  <span class="dt">loglik  =</span> loglik,</span>
<span id="cb72-26"><a href="probit.html#cb72-26"></a>  <span class="dt">rho     =</span> rho,</span>
<span id="cb72-27"><a href="probit.html#cb72-27"></a>  <span class="dt">Private =</span> coefsPrivate,</span>
<span id="cb72-28"><a href="probit.html#cb72-28"></a>  <span class="dt">Vote    =</span> coefsVote</span>
<span id="cb72-29"><a href="probit.html#cb72-29"></a>)</span></code></pre></div>
<pre><code>$loglik
[1] 89.25407

$rho
[1] -0.2695802

$Private
        Int       years     logptax      loginc 
-4.14327955 -0.01193699 -0.11030513  0.37459892 

$Vote
        Int       years     logptax      loginc 
-0.52933721 -0.01686685 -1.28983223  0.99840976 </code></pre>
</div>
</div>
<div id="source-5" class="section level2">
<h2>Source</h2>
<p>Base R source code found at <a href="https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/bivariateProbit.R" class="uri">https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/bivariateProbit.R</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mixed-model-ML.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="heckman-selection.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/models-by-example/blob/master/probit.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
